<!DOCTYPE html>
<html>
<head>
    <title>Storage Test</title>
</head>
<body>
    <script type="module">
        // GSTATIC URLS
        // ------------------------------------------------------
        // https://firebase.google.com/docs/hosting/reserved-urls
        // ------------------------------------------------------
        // CLOUD STORAGE
        // https://firebase.google.com/docs/storage/web/start

        // INITIALISE APP
        import { initializeApp } from "https://www.gstatic.com/firebasejs/10.12.5/firebase-app.js";
        // CLOUD STORAGE
        import { getStorage, ref, getDownloadURL } from "https://www.gstatic.com/firebasejs/10.12.5/firebase-storage.js";
        // For Firebase JS SDK v7.20.0 and later, measurementId is optional
        const firebaseConfig = {
            apiKey: "AIzaSyDsAD7cYKC7boqne9MLZ2y7b9AANgWk5OE",
            authDomain: "data-annotator-tool.firebaseapp.com",
            databaseURL: "https://data-annotator-tool-default-rtdb.asia-southeast1.firebasedatabase.app",
            projectId: "data-annotator-tool",
            storageBucket: "data-annotator-tool.appspot.com",
            messagingSenderId: "913657972954",
            appId: "1:913657972954:web:94e337e257d3452d7f3de3",
            measurementId: "G-RWJF94GG05"
        };
        const app = initializeApp(firebaseConfig);
        const storage = getStorage(app);
        const storageRef = ref(storage, 'Files');
        
        // const fileRef = ref(storage, "Files/sample_text1.txt");
        // let fileName = document.createElement("h1");
        // let details = `${fileRef.fullPath}/${fileRef.name}`;
        // fileName.textContent = details;
        // document.body.appendChild(fileName);

        let fileContents = document.createElement("p");
        // let contentsText = `${fileRef.}`
        // getDownloadURL(ref(storage, 'Files/Projects/P12345/sample_text1.txt')).then((url) => {
        //     console.log("1");
        //     const xhr = new XMLHttpRequest();
        //     xhr.responseType = 'blob';
        //     xhr.onload = function(event) {
        //         var blob = xhr.response;
        //         console.log(json);
        //     };
        //     xhr.open('GET', url);
        //     xhr.send();
        // }).catch(err => {
        //     console.log(err);
        // })

        getDownloadURL(ref(storage, 'Files/Projects/P12345/sample_text1.txt'))
        .then((url) => {
            // `url` is the download URL for 'images/stars.jpg'

            // This can be downloaded directly:
            const xhr = new XMLHttpRequest();
            xhr.responseType = 'blob';
            xhr.onload = (event) => {
            const blob = xhr.response;
            };
            xhr.open('GET', url);
            xhr.send();

            // Or inserted into an <img> element
            const img = document.createElement('p');
            img.textContent = url;
        })

        console.log("Test");

    </script>
    Hello World


</body>

</html>